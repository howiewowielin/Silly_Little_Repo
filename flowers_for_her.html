<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>a bouquet for you ðŸŒ¹</title>
<style>
:root{
  --bg:#0b0f10; --fg:#e9f7f0;
  --rose:#ff7db6; --rose2:#ff97c8; --leaf:#78e9ae;
  --ribbon:#ff8fc6; --ribbon-dark:#ff6db6;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;overflow:hidden}
.stars{position:fixed;inset:0;z-index:0;pointer-events:none}
.stars span{position:absolute;width:2px;height:2px;background:#fff2;border-radius:50%;animation:twinkle 3s infinite}
@keyframes twinkle{50%{opacity:.35;transform:scale(.85)}}

.wrap{position:relative; z-index:1; height:100%; display:grid; place-items:center; padding:24px}
.stage{position:relative; width:min(980px,95vw); height:min(640px,75vh); border-radius:18px;
  background:rgba(12,16,17,.82); border:1px solid #ffffff18; overflow:hidden;
  box-shadow:0 25px 120px rgba(0,0,0,.55), inset 0 0 0 1px #ffffff0f}
#garden{position:absolute; inset:0; width:100%; height:100%; display:block}

.note{position:absolute; left:50%; bottom:14px; transform:translateX(-50%);
  background:#00000066; color:#fff; padding:10px 14px; border-radius:14px;
  border:1px solid #ffffff18; font-size:16px; text-align:center}

/* Paper cone + bow */
.wrapSVG{position:absolute; left:50%; bottom:-10px; transform:translateX(-50%);
  width:380px; height:320px; pointer-events:none; opacity:0; animation:wrapIn .9s .8s ease forwards; will-change:transform,opacity}
@keyframes wrapIn{from{transform:translate(-50%,40px) scale(.96);opacity:0}to{transform:translate(-50%,0) scale(1);opacity:1}}
.bowFloat{animation:bowPop .7s 1.2s ease both; will-change:transform,opacity}
@keyframes bowPop{0%{transform:translate(-50%,8px) scale(.8);opacity:0}60%{transform:translate(-50%,-2px) scale(1.06);opacity:1}100%{transform:translate(-50%,0) scale(1)}}

/* Grow-in for flowers */
.grow{transform-origin:50% 100%; opacity:0; animation:grow .7s ease forwards; will-change:transform,opacity}
@keyframes grow{0%{transform:translateY(12px) scale(.75);opacity:0}70%{opacity:1}100%{transform:translateY(0) scale(1);opacity:1}}
</style>
</head>
<body>

<!-- starry background -->
<div class="stars" id="stars"></div>

<div class="wrap">
  <div class="stage" role="region" aria-label="pink rose bouquet">
    <svg id="garden" viewBox="0 0 980 640" preserveAspectRatio="xMidYMid slice" aria-label="rose garden"></svg>

    <!-- Paper wrap + bow (overlays stems) -->
    <svg class="wrapSVG" id="wrapSVG" viewBox="0 0 380 320" aria-hidden="true">
      <defs>
        <linearGradient id="paper" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#ffe8f3"/>
          <stop offset="100%" stop-color="#ffd3ea"/>
        </linearGradient>
        <linearGradient id="shadow" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#0000"/>
          <stop offset="100%" stop-color="#0003"/>
        </linearGradient>
      </defs>
      <!-- cone -->
      <path d="M190 312 L30 70 Q190 120 350 70 Z"
            fill="url(#paper)" stroke="#ffffff66" stroke-width="2"/>
      <path d="M190 312 L30 70 Q190 120 350 70 Z" fill="url(#shadow)"/>
      <!-- ribbon band -->
      <rect x="80" y="140" width="220" height="20" rx="10" fill="#ff8fc6"/>
      <!-- bow -->
      <g class="bowFloat" transform="translate(190,150)">
        <rect x="-14" y="-12" width="28" height="24" rx="6" fill="#ff6db6"/>
        <path d="M-14 -4 C -54 -26, -64 8, -22 16 Z" fill="#ff8fc6"/>
        <path d="M14 -4 C 54 -26, 64 8, 22 16 Z" fill="#ff8fc6"/>
      </g>
    </svg>

    <div id="bubble" class="note">ðŸ’Œ Thinking of you</div>
    <!-- To change the note, edit the text above or in JS:
         document.getElementById('bubble').textContent = 'ðŸ’Œ Your message'; -->
  </div>
</div>

<script>
// --- starfield ---
(function(){
  const el=document.getElementById('stars');
  for(let i=0;i<90;i++){
    const s=document.createElement('span');
    s.style.left=Math.random()*100+'%';
    s.style.top=Math.random()*100+'%';
    s.style.width=s.style.height=(Math.random()*2+1)+'px';
    s.style.animationDelay=(Math.random()*3)+'s';
    el.appendChild(s);
  }
})();

const svg=document.getElementById('garden');
const wrapSVG=document.getElementById('wrapSVG');

function getSize(){
  const r = svg.getBoundingClientRect();
  return {w:r.width, h:r.height};
}
function rand(a,b){return a+Math.random()*(b-a);}
function gaussian(){let u=0,v=0;while(!u)u=Math.random();while(!v)v=Math.random();
  return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}

const roses=[]; // {g, x, y, phase, amp, speed}
function makeRose(x,y,delay=0, simple=false){
  const g=document.createElementNS('http://www.w3.org/2000/svg','g');
  g.setAttribute('transform',`translate(${x},${y})`);
  g.style.filter='drop-shadow(0 2px 5px rgba(0,0,0,.35))';
  if(!simple){
    g.style.animationDelay = `${delay}ms`;
    g.setAttribute('class','grow');
  }

  const stem=document.createElementNS(svg.namespaceURI,'path');
  const h=rand(120,165),sway=rand(-10,10);
  stem.setAttribute('d',`M0 0 q ${sway/2} ${-h/2} ${sway} ${-h}`);
  stem.setAttribute('fill','none');
  stem.setAttribute('stroke','#68d39a');
  stem.setAttribute('stroke-width','3');
  stem.setAttribute('stroke-linecap','round');

  const leaf=document.createElementNS(svg.namespaceURI,'path');
  leaf.setAttribute('d','M0 -40 q 24 -12 46 0 q -24 12 -46 0 z');
  leaf.setAttribute('fill','#78e9ae');
  leaf.setAttribute('opacity','.88');
  leaf.setAttribute('transform',`rotate(${rand(-12,12)})`);

  const petals=document.createElementNS(svg.namespaceURI,'g');
  const radius=rand(18,26), layers=Math.floor(rand(3,5));
  const hue=335;
  for(let L=0;L<layers;L++){
    const n=Math.floor(rand(10,16));
    const r=radius*(0.55+(L/layers)*0.65);
    for(let i=0;i<n;i++){
      const petal=document.createElementNS(svg.namespaceURI,'path');
      const ang=i*(2*Math.PI/n)+rand(-0.06,0.06);
      const px=r*Math.cos(ang), py=r*Math.sin(ang);
      petal.setAttribute('d','M0 0 C 10 -14, 22 -10, 24 0 C 22 12, 10 10, 0 0 Z');
      const light=58+(L*8)+rand(-3,3);
      const col = `hsl(${hue+rand(-3,3)} 85% ${light}%)`;
      petal.setAttribute('fill', col);
      petal.setAttribute('transform',`translate(${px},${py-h}) rotate(${ang*57.3 + rand(-6,6)}) scale(${rand(0.85,1.05)})`);
      petals.appendChild(petal);
    }
  }
  const swirl=document.createElementNS(svg.namespaceURI,'path');
  swirl.setAttribute('d','M0 0 c 8 -6 16 -2 14 6 c -2 8 -12 8 -16 2 c -5 -6 -1 -12 5 -14');
  swirl.setAttribute('transform',`translate(0,${-h})`);
  swirl.setAttribute('stroke',`hsl(335 60% 45%)`);
  swirl.setAttribute('fill','none');
  swirl.setAttribute('stroke-width','2');
  petals.appendChild(swirl);

  g.append(stem,leaf,petals);
  svg.appendChild(g);

  // collect for single RAF loop
  roses.push({
    g, x, y,
    phase: Math.random()*Math.PI*2,
    amp: rand(1,3),
    speed: rand(0.0015,0.0035)
  });
}

function seedCluster(count=20, simple=false){
  const {w,h}=getSize();
  const cx=w/2, cy=h-80;
  for(let k=0;k<count;k++){
    const r=Math.abs(gaussian())*0.085*w; // scale with width
    const ang=Math.random()*Math.PI;      // forward fan
    const x=cx + r*Math.cos(ang);
    const y=cy - Math.abs(gaussian())*0.075*h - 18;
    makeRose(x,y, k*60, simple);
  }
}

// Single RAF for all roses (smoother on laptops)
let start=null;
function animateAll(ts){
  if(!start) start=ts;
  const t = ts - start;
  for(const R of roses){
    const dx = Math.sin(R.phase + t*R.speed) * R.amp;
    R.g.setAttribute('transform',`translate(${R.x+dx},${R.y})`);
  }
  requestAnimationFrame(animateAll);
}

// Init
(function(){
  const params = new URLSearchParams(location.search);
  const simple = params.has('simple'); // add ?simple=1 to disable grow/bow animations
  seedCluster(simple ? 14 : 22, simple);
  requestAnimationFrame(animateAll);
  if(simple){
    // show wrap immediately in simple mode
    wrapSVG.style.animation = 'none';
    wrapSVG.style.opacity = '1';
  }
  // Optional note via ?note=...
  const n = params.get('note');
  if(n) document.getElementById('bubble').textContent = 'ðŸ’Œ ' + n;
})();

// Resize handling: reseed on hard resizes (laptops rotating/zoom)
let resizeTO;
window.addEventListener('resize', ()=>{
  clearTimeout(resizeTO);
  resizeTO = setTimeout(()=>{
    // rebuild scene to fit new size
    while(svg.firstChild) svg.removeChild(svg.firstChild);
    roses.length = 0;
    seedCluster(22, false);
  }, 120);
});
</script>
</body>
</html>
